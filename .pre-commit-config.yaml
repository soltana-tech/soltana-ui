repos:
  # Baseline checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: detect-private-key
      - id: check-json
      - id: check-toml
      - id: check-yaml
      - id: check-merge-conflict
      - id: check-case-conflict
      - id: check-added-large-files
        args: ['--maxkb=102400']
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: mixed-line-ending

  # Formatting
  - repo: local
    hooks:
      - id: prettier
        name: Prettier
        entry: pnpm exec prettier --write
        language: system
        types_or: [javascript, jsx, ts, tsx, scss, css, json, html]

  # Markdown
  - repo: https://github.com/DavidAnson/markdownlint-cli2
    rev: v0.21.0
    hooks:
      - id: markdownlint-cli2

  # Python
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.15.1
    hooks:
      - id: ruff-check
        args: [--fix, --exit-non-zero-on-fix]
      - id: ruff-format
        args: [--check]
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.19.1
    hooks:
      - id: mypy
        args: [--config-file=python/soltana-matplotlib/pyproject.toml]
        files: ^python/soltana-matplotlib/soltana_matplotlib/
        additional_dependencies: [matplotlib>=3.7]
  - repo: https://github.com/jendrikseipp/vulture
    rev: v2.14
    hooks:
      - id: vulture
        args: [python/soltana-matplotlib/soltana_matplotlib, python/soltana-matplotlib/tests]
        files: ^python/
  - repo: https://github.com/econchick/interrogate
    rev: 1.7.0
    hooks:
      - id: interrogate
        args: [-c, python/soltana-matplotlib/pyproject.toml]
        files: ^python/.*\.py$
        exclude: /tests/

  # JavaScript / TypeScript / SCSS
  - repo: local
    hooks:
      - id: eslint
        name: ESLint
        entry: pnpm exec eslint
        language: system
        files: \.[jt]sx?$
        types: [file]
      - id: stylelint
        name: Stylelint
        entry: pnpm exec stylelint
        language: system
        files: \.(scss|css)$
      - id: tsc
        name: TypeScript
        entry: pnpm run type-check
        language: system
        files: \.(ts|tsx)$
        pass_filenames: false

  # Cross-package sync
  - repo: local
    hooks:
      - id: mplstyle-sync
        name: mplstyle sync check
        entry: diff -q packages/tokens/dist/matplotlib/ python/soltana-matplotlib/soltana_matplotlib/ --exclude='__*' --exclude='py.typed'
        language: system
        files: \.(mplstyle|ts)$
        pass_filenames: false
