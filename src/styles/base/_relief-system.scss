// ---------------------------------------------------------------------------
// Relief System
// ---------------------------------------------------------------------------
// Owns three layers of the design system abstraction:
// 1. RELIEF PRIMITIVES (--neu-*, --glass-*, --metallic-*, --stone-*)
//    Derived from theme channel tokens (--shadow-color, --highlight-color).
//    Per-theme overrides handle reliefs with unique color bases.
// 2. RELIEF TOKENS (--relief-bg, --relief-shadow-*, --relief-border)
//    Set by [data-relief] selectors, consumed by all components.
// 3. FINISH TOKENS (--finish-blur, --finish-saturation, etc.)
//    Set by [data-finish] selectors. Orthogonal to reliefs.
// Reliefs define depth and structure. Finishes define texture and treatment.
// The two tiers are orthogonal — every combination produces a valid result.
// ---------------------------------------------------------------------------

// ============================================================================
// RELIEF PRIMITIVES
// ============================================================================
// Derived from theme channel tokens (--shadow-color, --highlight-color).
// Per-theme overrides below handle reliefs whose base colors differ.
// Consumed by relief selectors and relief utility files.
// ============================================================================

:root,
[data-theme='dark'],
.theme-dark {
  // Neumorphic
  --neu-bg: var(--surface-2);
  --neu-shadow-dark: rgb(var(--shadow-color) / 65%);
  --neu-shadow-light: rgb(var(--highlight-color) / 5%);
  --neu-shadow-mid: rgb(var(--shadow-color) / 40%);
  --neu-highlight: rgb(var(--highlight-color) / 8%);
  --neu-accent-glow: var(--accent-glow);

  // Glassmorphic
  --glass-bg: rgb(14 16 40 / 35%);
  --glass-border: rgb(var(--highlight-color) / 8%);
  --glass-shadow: rgb(var(--shadow-color) / 45%);
  --glass-gradient-start: rgb(var(--highlight-color) / 8%);
  --glass-gradient-end: rgb(var(--highlight-color) / 3%);
  --glass-inner-glow: rgb(var(--highlight-color) / 10%);

  // Metallic
  --metallic-shadow: rgb(var(--shadow-color) / 50%);
  --metallic-highlight: rgb(var(--highlight-color) / 20%);
  --metallic-border: rgb(var(--highlight-color) / 15%);

  // Stone
  --stone-shadow: rgb(var(--shadow-color) / 40%);
  --stone-highlight: rgb(var(--highlight-color) / 8%);
  --stone-border: rgb(var(--highlight-color) / 6%);
}

[data-theme='light'],
.theme-light {
  // Neumorphic — inverted depth (strong highlights, soft shadows)
  --neu-bg: var(--surface-3);
  --neu-shadow-dark: rgb(var(--shadow-color) / 35%);
  --neu-shadow-light: rgb(var(--highlight-color) / 88%);
  --neu-shadow-mid: rgb(var(--shadow-color) / 20%);
  --neu-highlight: rgb(var(--highlight-color) / 65%);

  // Glassmorphic
  --glass-bg: rgb(var(--highlight-color) / 35%);
  --glass-border: rgb(146 156 176 / 15%); // blue-gray
  --glass-shadow: rgb(85 97 120 / 10%); // darker blue-gray
  --glass-gradient-start: rgb(var(--highlight-color) / 50%);
  --glass-gradient-end: rgb(238 240 245 / 30%); // surface-2 channels
  --glass-inner-glow: rgb(var(--highlight-color) / 45%);

  // Metallic
  --metallic-shadow: rgb(0 0 0 / 20%); // pure black
  --metallic-highlight: rgb(var(--highlight-color) / 70%);
  --metallic-border: rgb(var(--shadow-color) / 20%);

  // Stone
  --stone-shadow: rgb(var(--shadow-color) / 30%);
  --stone-highlight: rgb(var(--highlight-color) / 50%);
  --stone-border: rgb(var(--shadow-color) / 12%);
}

[data-theme='sepia'],
.theme-sepia {
  // Neumorphic — warm parchment depth
  --neu-shadow-dark: rgb(var(--shadow-color) / 45%);
  --neu-shadow-light: rgb(var(--highlight-color) / 82%);
  --neu-shadow-mid: rgb(var(--shadow-color) / 28%);
  --neu-highlight: rgb(var(--highlight-color) / 58%);

  // Glassmorphic
  --glass-bg: rgb(232 220 192 / 45%); // surface-bg channels
  --glass-border: rgb(160 110 43 / 18%); // accent-primary channels
  --glass-shadow: rgb(94 63 27 / 14%); // warm brown
  --glass-gradient-start: rgb(var(--highlight-color) / 55%);
  --glass-gradient-end: rgb(232 220 192 / 28%); // surface-bg channels
  --glass-inner-glow: rgb(var(--highlight-color) / 48%);

  // Metallic — warm bronze
  --metallic-shadow: rgb(60 50 35 / 35%); // warm dark
  --metallic-highlight: rgb(255 245 220 / 30%); // warm white
  --metallic-border: rgb(160 110 43 / 22%); // accent channels

  // Stone
  --stone-shadow: rgb(var(--shadow-color) / 35%);
  --stone-highlight: rgb(var(--highlight-color) / 40%);
  --stone-border: rgb(var(--shadow-color) / 14%);
}

// ============================================================================
// DEFAULT VALUES (neumorphic baseline — primitives defined above)
// ============================================================================
// Ensures components render correctly even without initSoltana().

:root {
  // Relief defaults (neumorphic baseline)
  --relief-bg: var(--neu-bg);
  --relief-shadow-sm: 2px 2px 5px var(--neu-shadow-dark), -2px -2px 5px var(--neu-shadow-light);
  --relief-shadow: 3px 3px 8px var(--neu-shadow-dark), -3px -3px 8px var(--neu-shadow-light);
  --relief-shadow-lg: 6px 6px 16px var(--neu-shadow-dark), -5px -5px 14px var(--neu-shadow-light);
  --relief-shadow-inset-sm:
    inset 1px 1px 3px var(--neu-shadow-dark), inset -1px -1px 3px var(--neu-shadow-light);
  --relief-shadow-inset:
    inset 2px 2px 5px var(--neu-shadow-dark), inset -2px -2px 5px var(--neu-shadow-light);
  --relief-shadow-inset-lg:
    inset 4px 4px 10px var(--neu-shadow-dark), inset -4px -4px 10px var(--neu-shadow-light);
  --relief-border: var(--border-default);

  // Finish defaults (polished baseline)
  --finish-blur: 0px;
  --finish-saturation: 100%;
  --finish-opacity: 1;
  --finish-texture-opacity: 0;
  --finish-overlay: none;
  --finish-sheen: none;
}

// ============================================================================
// RELIEF SELECTORS
// ============================================================================
// Data-attribute selectors activated by initSoltana().
// Class selectors available for per-element overrides.

[data-relief='neu'],
.relief-neu {
  --relief-bg: var(--neu-bg);
  --relief-shadow-sm: 2px 2px 5px var(--neu-shadow-dark), -2px -2px 5px var(--neu-shadow-light);
  --relief-shadow: 3px 3px 8px var(--neu-shadow-dark), -3px -3px 8px var(--neu-shadow-light);
  --relief-shadow-lg: 6px 6px 16px var(--neu-shadow-dark), -5px -5px 14px var(--neu-shadow-light);
  --relief-shadow-inset-sm:
    inset 1px 1px 3px var(--neu-shadow-dark), inset -1px -1px 3px var(--neu-shadow-light);
  --relief-shadow-inset:
    inset 2px 2px 5px var(--neu-shadow-dark), inset -2px -2px 5px var(--neu-shadow-light);
  --relief-shadow-inset-lg:
    inset 4px 4px 10px var(--neu-shadow-dark), inset -4px -4px 10px var(--neu-shadow-light);
  --relief-border: var(--border-default);
}

[data-relief='glass'],
.relief-glass {
  --relief-bg: var(--glass-bg);
  --relief-shadow-sm: 0 4px 16px var(--glass-shadow);
  --relief-shadow: 0 8px 32px var(--glass-shadow);
  --relief-shadow-lg: 0 16px 48px var(--glass-shadow);
  --relief-shadow-inset-sm: inset 0 1px 0 var(--glass-inner-glow);
  --relief-shadow-inset: inset 0 1px 0 var(--glass-inner-glow);
  --relief-shadow-inset-lg:
    inset 0 2px 0 var(--glass-inner-glow), inset 0 0 12px var(--glass-shadow);
  --relief-border: var(--glass-border);
}

[data-relief='flat'],
.relief-flat {
  --relief-bg: var(--surface-1);
  --relief-shadow-sm: none;
  --relief-shadow: none;
  --relief-shadow-lg: none;
  --relief-shadow-inset-sm: none;
  --relief-shadow-inset: none;
  --relief-shadow-inset-lg: none;
  --relief-border: 1px solid var(--border-default);
}

[data-relief='soft'],
.relief-soft {
  --relief-bg: var(--surface-1);
  --relief-shadow-sm: 0 1px 2px rgb(0 0 0 / 5%);
  --relief-shadow: 0 1px 3px rgb(0 0 0 / 8%), 0 1px 2px rgb(0 0 0 / 6%);
  --relief-shadow-lg: 0 4px 8px rgb(0 0 0 / 10%), 0 2px 4px rgb(0 0 0 / 6%);
  --relief-shadow-inset-sm: inset 0 1px 0 rgb(255 255 255 / 3%);
  --relief-shadow-inset: inset 0 1px 0 rgb(255 255 255 / 4%);
  --relief-shadow-inset-lg: inset 0 2px 0 rgb(255 255 255 / 5%), inset 0 -1px 0 rgb(0 0 0 / 5%);
  --relief-border: 1px solid var(--border-subtle);
}

[data-relief='metallic'],
.relief-metallic {
  --relief-bg: var(--surface-1);
  --relief-shadow-sm: 0 1px 4px var(--metallic-shadow);
  --relief-shadow: 0 2px 8px var(--metallic-shadow), 0 0 1px var(--metallic-shadow);
  --relief-shadow-lg: 0 4px 16px var(--metallic-shadow), 0 0 2px var(--metallic-shadow);
  --relief-shadow-inset-sm: inset 0 1px 0 var(--metallic-highlight);
  --relief-shadow-inset: inset 0 1px 0 var(--metallic-highlight), inset 0 -1px 0 rgb(0 0 0 / 10%);
  --relief-shadow-inset-lg:
    inset 0 2px 0 var(--metallic-highlight), inset 0 -2px 0 rgb(0 0 0 / 12%);
  --relief-border: 1px solid var(--metallic-border);
}

[data-relief='stone'],
.relief-stone {
  --relief-bg: var(--surface-2);
  --relief-shadow-sm: 0 1px 3px var(--stone-shadow);
  --relief-shadow: 0 2px 6px var(--stone-shadow);
  --relief-shadow-lg: 0 4px 12px var(--stone-shadow);
  --relief-shadow-inset-sm:
    inset 1px 1px 1px var(--stone-highlight), inset -1px -1px 1px var(--stone-shadow);
  --relief-shadow-inset:
    inset 1px 1px 2px var(--stone-highlight), inset -1px -1px 2px var(--stone-shadow);
  --relief-shadow-inset-lg:
    inset 2px 2px 4px var(--stone-highlight), inset -2px -2px 4px var(--stone-shadow);
  --relief-border: 1px solid var(--stone-border);
}

// ============================================================================
// FINISH SELECTORS
// ============================================================================

[data-finish='polished'],
.finish-polished {
  --finish-blur: 0px;
  --finish-saturation: 100%;
  --finish-opacity: 1;
  --finish-texture-opacity: 0;
  --finish-overlay: none;
  --finish-sheen: none;
}

[data-finish='frosted'],
.finish-frosted {
  --finish-blur: 24px;
  --finish-saturation: 80%;
  --finish-opacity: 0.7;
  --finish-texture-opacity: 0.06;
}

[data-finish='stained'],
.finish-stained {
  --finish-blur: 28px;
  --finish-saturation: 100%;
  --finish-opacity: 1;
  --relief-bg: linear-gradient(
    135deg,
    var(--stained-primary),
    var(--stained-secondary),
    var(--stained-accent)
  );
  --relief-border: 2px solid rgb(40 35 30 / 40%);
  --finish-overlay: linear-gradient(
    135deg,
    rgb(212 168 67 / 6%),
    rgb(168 85 247 / 5%),
    rgb(16 185 129 / 4%)
  );
}

[data-finish='metallic'],
.finish-metallic {
  --finish-blur: 0px;
  --finish-saturation: 100%;
  --finish-opacity: 1;
  --relief-bg: linear-gradient(
    145deg,
    rgb(255 255 255 / 15%) 0%,
    transparent 40%,
    transparent 60%,
    rgb(0 0 0 / 10%) 100%
  );
  --finish-sheen: linear-gradient(
    145deg,
    rgb(255 255 255 / 12%) 0%,
    transparent 35%,
    transparent 65%,
    rgb(0 0 0 / 8%) 100%
  );
}

// ============================================================================
// ORNAMENT SELECTORS (opt-in via .ornament class)
// ============================================================================
// Ornaments apply only to elements with .ornament or .ornament-* classes.
// Config-default: .ornament reads the active ornament from [data-ornament].
// Explicit override: .ornament-baroque forces baroque regardless of config.
// All implementations use box-shadow — no ::before/::after conflicts.
// Each includes var(--relief-shadow) so relief depth is preserved.
// ============================================================================

// ---- Config-default (reads from [data-ornament] on <html>) ----

[data-ornament='baroque'] .ornament {
  box-shadow:
    var(--relief-shadow),
    inset 0 0 0 3px var(--border-accent-gold, rgb(212 168 67 / 25%)),
    0 0 8px var(--accent-glow, rgb(212 168 67 / 15%));
}

[data-ornament='carved'] .ornament {
  box-shadow:
    var(--relief-shadow),
    inset 1px 1px 0 rgb(var(--highlight-color) / 12%),
    inset -1px -1px 0 rgb(var(--shadow-color) / 10%);
}

[data-ornament='faceted'] .ornament {
  box-shadow:
    var(--relief-shadow),
    inset 3px 3px 6px rgb(var(--highlight-color) / 8%),
    inset -2px -2px 4px rgb(var(--shadow-color) / 5%);
}

[data-ornament='gilt'] .ornament {
  box-shadow:
    var(--relief-shadow),
    inset 0 0 0 2px var(--border-accent-gold, rgb(212 168 67 / 20%)),
    0 0 0 1px var(--accent-gold, #d4a843),
    0 0 12px var(--accent-glow, rgb(212 168 67 / 15%));
}

// ---- Explicit per-element overrides ----
// Comma selector ensures these win over config-default at any specificity.

.ornament-baroque,
.ornament.ornament-baroque {
  box-shadow:
    var(--relief-shadow),
    inset 0 0 0 3px var(--border-accent-gold, rgb(212 168 67 / 25%)),
    0 0 8px var(--accent-glow, rgb(212 168 67 / 15%));
}

.ornament-carved,
.ornament.ornament-carved {
  box-shadow:
    var(--relief-shadow),
    inset 1px 1px 0 rgb(var(--highlight-color) / 12%),
    inset -1px -1px 0 rgb(var(--shadow-color) / 10%);
}

.ornament-faceted,
.ornament.ornament-faceted {
  box-shadow:
    var(--relief-shadow),
    inset 3px 3px 6px rgb(var(--highlight-color) / 8%),
    inset -2px -2px 4px rgb(var(--shadow-color) / 5%);
}

.ornament-gilt,
.ornament.ornament-gilt {
  box-shadow:
    var(--relief-shadow),
    inset 0 0 0 2px var(--border-accent-gold, rgb(212 168 67 / 20%)),
    0 0 0 1px var(--accent-gold, #d4a843),
    0 0 12px var(--accent-glow, rgb(212 168 67 / 15%));
}
