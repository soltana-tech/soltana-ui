// ---------------------------------------------------------------------------
// Relief System
// ---------------------------------------------------------------------------
// Owns three layers of the design system abstraction:
// 1. RELIEF PRIMITIVES (--neu-*)
//    Derived from theme channel tokens (--shadow-color, --highlight-color).
//    Per-theme overrides handle reliefs with unique color bases.
// 2. RELIEF TOKENS (--relief-bg, --relief-shadow-*, --relief-border)
//    Set by [data-relief] selectors, consumed by all components.
// 3. FINISH TOKENS (--finish-blur, --finish-saturation, etc.)
//    Set by [data-finish] selectors. Orthogonal to reliefs.
// Reliefs define depth and structure. Finishes define texture and treatment.
// The two tiers are orthogonal — every combination produces a valid result.
// ---------------------------------------------------------------------------

@use 'register' as *;

// ============================================================================
// RELIEF PRIMITIVES
// ============================================================================
// Derived from theme channel tokens (--shadow-color, --highlight-color).
// Per-theme overrides below handle reliefs whose base colors differ.
// Consumed by relief selectors and relief utility files.
// ============================================================================

:root,
[data-theme='dark'],
.theme-dark {
  // Neumorphic
  --neu-bg: var(--surface-2);
  --neu-shadow-dark: rgb(var(--shadow-color) / 65%);
  --neu-shadow-light: rgb(var(--highlight-color) / 5%);
  --neu-shadow-mid: rgb(var(--shadow-color) / 40%);
  --neu-highlight: rgb(var(--highlight-color) / 8%);
}

[data-theme='light'],
.theme-light {
  // Neumorphic — inverted depth (strong highlights, soft shadows)
  --neu-bg: var(--surface-3);
  --neu-shadow-dark: rgb(var(--shadow-color) / 35%);
  --neu-shadow-light: rgb(var(--highlight-color) / 88%);
  --neu-shadow-mid: rgb(var(--shadow-color) / 20%);
  --neu-highlight: rgb(var(--highlight-color) / 65%);
}

[data-theme='sepia'],
.theme-sepia {
  // Neumorphic — warm parchment depth
  --neu-bg: var(--surface-3);
  --neu-shadow-dark: rgb(var(--shadow-color) / 45%);
  --neu-shadow-light: rgb(var(--highlight-color) / 82%);
  --neu-shadow-mid: rgb(var(--shadow-color) / 28%);
  --neu-highlight: rgb(var(--highlight-color) / 58%);
}

// ============================================================================
// RELIEF SELECTORS
// ============================================================================
// Data-attribute selectors activated by initSoltana().
// Class selectors available for per-element overrides.

@include register-relief('neu') {
  --relief-bg: var(--neu-bg);
  --relief-shadow-sm: 2px 2px 5px var(--neu-shadow-dark), -2px -2px 5px var(--neu-shadow-light);
  --relief-shadow: 3px 3px 8px var(--neu-shadow-dark), -3px -3px 8px var(--neu-shadow-light);
  --relief-shadow-lg: 6px 6px 16px var(--neu-shadow-dark), -5px -5px 14px var(--neu-shadow-light);
  --relief-shadow-inset-sm:
    inset 1px 1px 3px var(--neu-shadow-dark), inset -1px -1px 3px var(--neu-shadow-light);
  --relief-shadow-inset:
    inset 2px 2px 5px var(--neu-shadow-dark), inset -2px -2px 5px var(--neu-shadow-light);
  --relief-shadow-inset-lg:
    inset 4px 4px 10px var(--neu-shadow-dark), inset -4px -4px 10px var(--neu-shadow-light);
  --relief-border: var(--border-default);
}

@include register-relief('flat') {
  --relief-bg: var(--surface-1);
  --relief-shadow-sm: none;
  --relief-shadow: none;
  --relief-shadow-lg: none;
  --relief-shadow-inset-sm: none;
  --relief-shadow-inset: none;
  --relief-shadow-inset-lg: none;
  --relief-border: 1px solid var(--border-default);
}

@include register-relief('soft') {
  --relief-bg: var(--surface-1);
  --relief-shadow-sm: 0 1px 2px rgb(var(--shadow-color) / 5%);
  --relief-shadow: 0 1px 3px rgb(var(--shadow-color) / 8%), 0 1px 2px rgb(var(--shadow-color) / 6%);
  --relief-shadow-lg:
    0 4px 8px rgb(var(--shadow-color) / 10%), 0 2px 4px rgb(var(--shadow-color) / 6%);
  --relief-shadow-inset-sm: inset 0 1px 0 rgb(var(--highlight-color) / 3%);
  --relief-shadow-inset: inset 0 1px 0 rgb(var(--highlight-color) / 4%);
  --relief-shadow-inset-lg:
    inset 0 2px 0 rgb(var(--highlight-color) / 5%), inset 0 -1px 0 rgb(var(--shadow-color) / 5%);
  --relief-border: 1px solid var(--border-subtle);
}

@include register-relief('lifted') {
  --relief-bg: var(--surface-2);
  --relief-shadow-sm:
    0 1px 3px rgb(var(--shadow-color) / 12%), 0 1px 2px rgb(var(--shadow-color) / 24%);
  --relief-shadow:
    0 3px 6px rgb(var(--shadow-color) / 16%), 0 3px 6px rgb(var(--shadow-color) / 23%);
  --relief-shadow-lg:
    0 10px 20px rgb(var(--shadow-color) / 19%), 0 6px 6px rgb(var(--shadow-color) / 23%);
  --relief-shadow-inset-sm: inset 0 1px 2px rgb(var(--shadow-color) / 10%);
  --relief-shadow-inset: inset 0 2px 4px rgb(var(--shadow-color) / 14%);
  --relief-shadow-inset-lg: inset 0 4px 8px rgb(var(--shadow-color) / 18%);
  --relief-border: 1px solid rgb(var(--shadow-color) / 6%);
}

@include register-relief('sharp') {
  --relief-bg: var(--surface-2);
  --relief-shadow-sm: 2px 2px 0 rgb(var(--shadow-color) / 20%);
  --relief-shadow: 4px 4px 0 rgb(var(--shadow-color) / 25%);
  --relief-shadow-lg: 8px 8px 0 rgb(var(--shadow-color) / 30%);
  --relief-shadow-inset-sm: inset 2px 2px 0 rgb(var(--shadow-color) / 15%);
  --relief-shadow-inset: inset 3px 3px 0 rgb(var(--shadow-color) / 20%);
  --relief-shadow-inset-lg: inset 5px 5px 0 rgb(var(--shadow-color) / 25%);
  --relief-border: 1px solid rgb(var(--shadow-color) / 15%);
}

@include register-relief('hewn') {
  --relief-bg: var(--surface-2);
  --relief-shadow-sm:
    inset 2px 2px 4px rgb(var(--shadow-color) / 18%),
    inset -1px -1px 3px rgb(var(--highlight-color) / 5%);
  --relief-shadow:
    inset 3px 3px 6px rgb(var(--shadow-color) / 22%),
    inset -2px -2px 4px rgb(var(--highlight-color) / 6%);
  --relief-shadow-lg:
    inset 5px 5px 10px rgb(var(--shadow-color) / 28%),
    inset -3px -3px 6px rgb(var(--highlight-color) / 7%);
  --relief-shadow-inset-sm: inset 1px 1px 3px rgb(var(--shadow-color) / 15%);
  --relief-shadow-inset: inset 2px 2px 5px rgb(var(--shadow-color) / 20%);
  --relief-shadow-inset-lg: inset 4px 4px 8px rgb(var(--shadow-color) / 25%);
  --relief-border: 1px solid rgb(var(--shadow-color) / 10%);
}

// ============================================================================
// FINISH SELECTORS
// ============================================================================

@include register-finish('matte') {
  --finish-blur: 0px;
  --finish-saturation: 100%;
  --finish-opacity: 1;
  --finish-texture-opacity: 0;
  --finish-overlay: none;
  --finish-sheen: none;
}

@include register-finish('translucent') {
  --finish-blur: 0px;
  --finish-saturation: 100%;
  --finish-opacity: 0.65;
  --finish-texture-opacity: 0;
  --finish-overlay: none;
  --finish-sheen: none;
}

@include register-finish('frosted') {
  --finish-blur: 24px;
  --finish-saturation: 80%;
  --finish-opacity: 0.7;
  --finish-texture-opacity: 0.06;
}

@include register-finish('tinted') {
  --finish-blur: 0px;
  --finish-saturation: 100%;
  --finish-opacity: 1;
  --finish-texture-opacity: 0;
  --finish-overlay: linear-gradient(
    135deg,
    color-mix(in srgb, var(--accent-glow) 8%, transparent) 0%,
    transparent 50%,
    rgb(var(--shadow-color) / 6%) 100%
  );
  --finish-sheen: none;
}

@include register-finish('glossy') {
  --finish-blur: 0px;
  --finish-saturation: 100%;
  --finish-opacity: 1;
  --finish-texture-opacity: 0;
  --finish-overlay: none;
  --finish-sheen: linear-gradient(
    135deg,
    rgb(var(--highlight-color) / 12%) 0%,
    transparent 40%,
    rgb(var(--highlight-color) / 4%) 100%
  );
}

// ============================================================================
// ORNAMENT SELECTORS (opt-in via .ornament class)
// ============================================================================
// Ornaments apply only to elements with .ornament or .ornament-* classes.
// Tier token blocks in _ornamental.scss set --ornament-box-shadow.
// This rule consumes the token so relief depth is preserved.
// ============================================================================

.ornament {
  box-shadow: var(--relief-shadow), var(--ornament-box-shadow, 0 0 0 0 transparent);
}
